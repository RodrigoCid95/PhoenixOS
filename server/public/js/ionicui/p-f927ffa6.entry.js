import{r as t,d as i,w as s,h as o,H as e,c as n}from"./p-27fd00b4.js";import{i as r}from"./p-506221fe.js";import{c as a,h}from"./p-0e4de1d0.js";import{g as l}from"./p-c5fce703.js";let c=class{constructor(s){t(this,s),this.ionChange=i(this,"ionChange",7),this.ionSelect=i(this,"ionSelect",7),this.ionStyle=i(this,"ionStyle",7),this.onClick=t=>{const i=t.target,s=this.checked;"ION-SEGMENT"!==i.tagName&&(this.value=i.value,i!==s&&this.emitValueChange(),!this.scrollable&&this.swipeGesture||(s?this.checkButton(s,i):this.setCheckedClasses()))},this.getSegmentButton=t=>{var i,s;const o=this.getButtons().filter((t=>!t.disabled)),e=o.findIndex((t=>t===document.activeElement));switch(t){case"first":return o[0];case"last":return o[o.length-1];case"next":return null!==(i=o[e+1])&&void 0!==i?i:o[0];case"previous":return null!==(s=o[e-1])&&void 0!==s?s:o[o.length-1];default:return null}},this.activated=!1,this.color=void 0,this.disabled=!1,this.scrollable=!1,this.swipeGesture=!0,this.value=void 0,this.selectOnFocus=!1}colorChanged(t,i){(void 0===i&&void 0!==t||void 0!==i&&void 0===t)&&this.emitStyle()}swipeGestureChanged(){this.gestureChanged()}valueChanged(t){if(this.ionSelect.emit({value:t}),this.scrollable){const i=this.getButtons().find((i=>i.value===t));void 0!==i&&i.scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})}}disabledChanged(){this.gestureChanged();const t=this.getButtons();for(const i of t)i.disabled=this.disabled}gestureChanged(){this.gesture&&this.gesture.enable(!this.scrollable&&!this.disabled&&this.swipeGesture)}connectedCallback(){this.emitStyle()}componentWillLoad(){this.emitStyle()}async componentDidLoad(){this.setCheckedClasses(),this.gesture=(await import("./p-0b857c77.js")).createGesture({el:this.el,gestureName:"segment",gesturePriority:100,threshold:0,passive:!1,onStart:t=>this.onStart(t),onMove:t=>this.onMove(t),onEnd:t=>this.onEnd(t)}),this.gestureChanged(),this.disabled&&this.disabledChanged()}onStart(t){this.valueBeforeGesture=this.value,this.activate(t)}onMove(t){this.setNextIndex(t)}onEnd(t){this.setActivated(!1),this.setNextIndex(t,!0),t.event.stopImmediatePropagation();const i=this.value;void 0!==i&&this.valueBeforeGesture!==i&&this.emitValueChange(),this.valueBeforeGesture=void 0}emitValueChange(){const{value:t}=this;this.ionChange.emit({value:t})}getButtons(){return Array.from(this.el.querySelectorAll("ion-segment-button"))}get checked(){return this.getButtons().find((t=>t.value===this.value))}setActivated(t){this.getButtons().forEach((i=>{t?i.classList.add("segment-button-activated"):i.classList.remove("segment-button-activated")})),this.activated=t}activate(t){const i=t.event.target,s=this.getButtons().find((t=>t.value===this.value));"ION-SEGMENT-BUTTON"===i.tagName&&(s||(this.value=i.value,this.setCheckedClasses()),this.value===i.value&&this.setActivated(!0))}getIndicator(t){return(t.shadowRoot||t).querySelector(".segment-button-indicator")}checkButton(t,i){const o=this.getIndicator(t),e=this.getIndicator(i);if(null===o||null===e)return;const n=o.getBoundingClientRect(),r=e.getBoundingClientRect(),a=`translate3d(${n.left-r.left}px, 0, 0) scaleX(${n.width/r.width})`;s((()=>{e.classList.remove("segment-button-indicator-animated"),e.style.setProperty("transform",a),e.getBoundingClientRect(),e.classList.add("segment-button-indicator-animated"),e.style.setProperty("transform","")})),this.value=i.value,this.setCheckedClasses()}setCheckedClasses(){const t=this.getButtons(),i=t.findIndex((t=>t.value===this.value))+1;for(const i of t)i.classList.remove("segment-button-after-checked");i<t.length&&t[i].classList.add("segment-button-after-checked")}setNextIndex(t,i=!1){const s=r(this.el),o=this.activated,e=this.getButtons(),n=e.findIndex((t=>t.value===this.value)),a=e[n];let h,l;if(-1===n)return;const c=a.getBoundingClientRect(),d=c.left,u=c.width,g=t.currentX,m=c.top+c.height/2,b=this.el.getRootNode().elementFromPoint(g,m);if(o&&!i){if(s?g>d+u:g<d){const t=n-1;t>=0&&(l=t)}else if((s?g<d:g>d+u)&&o&&!i){const t=n+1;t<e.length&&(l=t)}void 0===l||e[l].disabled||(h=e[l])}if(!o&&i&&(h=b),null!=h){if("ION-SEGMENT"===h.tagName)return!1;a!==h&&this.checkButton(a,h)}return!0}emitStyle(){this.ionStyle.emit({segment:!0})}onKeyDown(t){const i=r(this.el);let s,o=this.selectOnFocus;switch(t.key){case"ArrowRight":t.preventDefault(),s=this.getSegmentButton(i?"previous":"next");break;case"ArrowLeft":t.preventDefault(),s=this.getSegmentButton(i?"next":"previous");break;case"Home":t.preventDefault(),s=this.getSegmentButton("first");break;case"End":t.preventDefault(),s=this.getSegmentButton("last");break;case" ":case"Enter":t.preventDefault(),s=document.activeElement,o=!0}if(s){if(o){const t=this.checked;this.checkButton(t||s,s),s!==t&&this.emitValueChange()}s.setFocus()}}render(){const t=l(this);return o(e,{role:"tablist",onClick:this.onClick,class:a(this.color,{[t]:!0,"in-toolbar":h("ion-toolbar",this.el),"in-toolbar-color":h("ion-toolbar[color]",this.el),"segment-activated":this.activated,"segment-disabled":this.disabled,"segment-scrollable":this.scrollable})},o("slot",null))}get el(){return n(this)}static get watchers(){return{color:["colorChanged"],swipeGesture:["swipeGestureChanged"],value:["valueChanged"],disabled:["disabledChanged"]}}};c.style={ios:":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:grid;grid-auto-columns:1fr;position:relative;align-items:stretch;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint;user-select:none}:host(.segment-scrollable){justify-content:start;width:auto;overflow-x:auto;grid-auto-columns:minmax(min-content, 1fr)}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.065);border-radius:8px;overflow:hidden;z-index:0}:host(.ion-color){background:rgba(var(--ion-color-base-rgb), 0.065)}:host(.in-toolbar){-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto;margin-top:0;margin-bottom:0;width:auto}:host(.in-toolbar:not(.ion-color)){background:var(--ion-toolbar-segment-background, var(--background))}:host(.in-toolbar-color:not(.ion-color)){background:rgba(var(--ion-color-contrast-rgb), 0.11)}",md:":host{--ripple-color:currentColor;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:grid;grid-auto-columns:1fr;position:relative;align-items:stretch;justify-content:center;width:100%;background:var(--background);font-family:var(--ion-font-family, inherit);text-align:center;contain:paint;user-select:none}:host(.segment-scrollable){justify-content:start;width:auto;overflow-x:auto;grid-auto-columns:minmax(min-content, 1fr)}:host(.segment-scrollable::-webkit-scrollbar){display:none}:host{--background:transparent;grid-auto-columns:minmax(auto, 360px)}:host(.in-toolbar){min-height:var(--min-height)}:host(.segment-scrollable) ::slotted(ion-segment-button){min-width:auto}"};export{c as ion_segment}